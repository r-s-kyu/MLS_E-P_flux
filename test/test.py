# %%
from matplotlib.pyplot import axes, axis
import numpy as np

a = np.arange(48,dtype=np.float32).reshape(2,4,6)
# print(a)
a[0,3,4:5] = np.nan
a[1,1,1:3] = np.nan
print('a')
print(a)
zonal = np.nanmean(a,axis=-1)
print('zonal')
print(zonal)
dev = (a.T-zonal.T).T
print('dev')
print(dev)
# %%


from matplotlib.pyplot import axes, axis
import numpy as np

a = np.arange(48,dtype=np.float32).reshape(2,4,6)
a[0,3,4:5] = np.nan
a[1,1,1:3] = np.nan
print(a)
b = np.gradient(a,2,axis=1)
print(b)
# %%
import numpy as np
import math

#  print(phidev[264,24,6])
#  print(x[6])

devphi = np.array([  641.51800568 ,  817.25596141 ,  739.02542755 ,  959.23057078,
   825.32708771  , 819.89170359 ,  939.42653432 ,  847.4496463,
   963.12021922   ,968.58636505 ,  895.22972443 ,  995.84515411,
   689.14730255   ,831.45127391 ,  697.33050568 ,  579.41878693,
   719.01702911   ,220.7121463  ,  412.84385203 ,  205.89463328,
   -76.36949432   ,-35.04547089 , -567.73199432 , -361.61513234,
  -536.53830943 , -831.5878537  , -882.30165578 ,-1017.57300995,
  -978.97711151 , -977.29579641 ,-1085.02398651 ,-1001.0191037,
  -981.76031464 , -868.99293182 ,-1001.82183807 , -810.60650604,
  -754.94618703 , -668.78961151 , -594.26636932 , -737.56890839,
  -631.73850474 , -526.16480682 , -831.86578339 , -393.53570526,
  -614.55621307 , -518.42177297 , -329.10439016 , -739.2925412,
  -238.14703339 , -498.22939016 , -452.16819224 , -245.97496307,
  -381.5347287  ,   88.05081818 , -203.27659068 , -138.18967661,
    50.90472443 , -117.03863495 ,  281.62386505 ,   94.62445099,
   194.23903432 ,  390.83792755 ,  204.85980255 ,  414.03460724,
   387.84066193 ,  484.42871996 ,  535.29827911 ,  516.44118276,
   594.07106557 ,  511.01644318 ,  756.62054474 ,  706.36077911,
   650.09567645])
l =  442625315782.8047

bibun = np.gradient(devphi,l)
print(bibun)

latphicord = np.arange(-90, 90.1, 5)*(math.pi/180.)
a = 6.37e+6

omega = 7.29e-5
lon_cord = np.arange(-180, 180.1, 5)
lat_cord = np.arange(-90, 90.1, 5)
f = 2*omega*np.sin(latphicord)
print(-bibun/f[6])
